SQL INSERT INTO SELECT Statement

Syntax
Following is the basic syntax to insert all columns in a table using INSERT INTO SELECT statement:

INSERT INTO target_table
SELECT * FROM source_table;
Following is the syntax to insert specific columns in a table using INSERT INTO SELECT statement:

INSERT INTO target_table (column1, column2, ...)
SELECT column1, column2, ...
FROM source_table;



INSERT INTO BUYERS
SELECT * FROM CUSTOMERS;


INSERT INTO BUYERS_PARTIAL (ID, NAME, AGE)
SELECT ID, NAME, AGE FROM CUSTOMERS;



INSERT INTO BUYERS
SELECT * FROM CUSTOMERS
WHERE AGE > 25;




INSERT INTO SELECT with NOT EXISTS
You can use the INSERT INTO SELECT statement along with the NOT EXISTS clause to prevent inserting duplicate records into the target table.

This is useful for transferring data based on a condition and making sure that no duplicate rows are inserted, particularly when using a unique column such as ID.

Syntax
Following is the basic syntax to use the NOT EXISTS clause with the INSERT INTO SELECT statement:

INSERT INTO target_table (column1, column2, ...)
SELECT column1, column2, ...
FROM source_table AS src
WHERE NOT EXISTS (
  SELECT 1 FROM target_table AS tgt
  WHERE tgt.unique_column = src.unique_column
);
Example
In the following example, we insert customers from CUSTOMERS into BUYERS only if their ID does not already exist in BUYERS:

INSERT INTO BUYERS (ID, NAME, AGE, ADDRESS, SALARY)
SELECT ID, NAME, AGE, ADDRESS, SALARY
FROM CUSTOMERS AS C
WHERE NOT EXISTS (
  SELECT 1 FROM BUYERS AS B
  WHERE B.ID = C.ID
);
We get the output as shown below:

Query OK, 0 rows affected (0.03 sec)
Records: 7  Duplicates: 0  Warnings: 0
Verification
To verify that no duplicates were inserted, query the BUYERS table as follows:

SELECT * FROM BUYERS;

